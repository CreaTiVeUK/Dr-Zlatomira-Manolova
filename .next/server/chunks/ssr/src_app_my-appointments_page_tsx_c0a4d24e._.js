module.exports=[77913,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56711),e=a.i(74016),f=a.i(42724),g=a.i(59296);function h(){let[a,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)("");async function m(){try{let a=await fetch("/api/appointments");if(a.ok){let b=await a.json();h(b.appointments)}}catch(a){console.error("Error fetching appointments:",a)}finally{j(!1)}}async function n(a,b){var c,d,h;let i=new Date(b),j=new Date;if(c=void 0,d=24*g.millisecondsInHour,h=(0,f.constructFrom)(c?.in||j,+(0,e.toDate)(j)+d),!(+(0,e.toDate)(i)>+(0,e.toDate)(h)))return void alert("Часовете могат да бъдат отменяни най-малко 24 часа предварително.");if(confirm("Сигурни ли сте, че искате да отмените този час?"))try{let b=await fetch(`/api/appointments?id=${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"CANCELLED"})});if(b.ok)l("Часът бе отменен успешно."),m();else{let a=await b.json();l(a.error||"Отмяната не бе успешна.")}}catch(a){l("Възникна грешка.")}}async function o(a){var b;let c,d,e=new Blob([(c=(b={id:a.id,dateTime:new Date(a.dateTime),duration:a.duration,summary:"Педиатричен преглед: Д-р Злати",description:`Сесия: ${a.notes||"Клинична консултация"}`}).dateTime.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",d=new Date(b.dateTime.getTime()+6e4*b.duration).toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",`BEGIN:VCALENDAR\r
VERSION:2.0\r
PRODID:-//Zlati Pediatrics//EN\r
BEGIN:VEVENT\r
UID:${b.id}\r
DTSTAMP:${new Date().toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"}\r
DTSTART:${c}\r
DTEND:${d}\r
SUMMARY:${b.summary}\r
DESCRIPTION:${b.description||""}\r
LOCATION:Dr. Zlati Pediatrics London\r
END:VEVENT\r
END:VCALENDAR`)],{type:"text/calendar;charset=utf-8"}),f=window.URL.createObjectURL(e),g=document.createElement("a");g.href=f,g.setAttribute("download","appointment.ics"),document.body.appendChild(g),g.click(),document.body.removeChild(g)}return((0,c.useEffect)(()=>{m()},[]),i)?(0,b.jsx)("div",{className:"container",style:{padding:"4rem 0",textAlign:"center"},children:"Зареждане..."}):(0,b.jsxs)("div",{className:"container",style:{padding:"4rem 0"},children:[(0,b.jsx)("h1",{style:{color:"var(--primary-teal)",textAlign:"center",marginBottom:"2rem"},children:"Моите часове"}),k&&(0,b.jsx)("div",{style:{padding:"1rem",background:"#e0f7fa",color:"#006064",borderRadius:"4px",textAlign:"center",marginBottom:"2rem"},children:k}),(0,b.jsx)("div",{style:{background:"white",padding:"2rem",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:0===a.length?(0,b.jsx)("p",{style:{textAlign:"center"},children:"Нямате предстоящи часове."}):(0,b.jsx)("div",{style:{display:"grid",gap:"1rem"},children:a.map(a=>(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #eee",paddingBottom:"1rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontWeight:"bold"},children:(0,d.format)(new Date(a.dateTime),"PPPP")}),(0,b.jsxs)("div",{style:{color:"#666"},children:[(0,d.format)(new Date(a.dateTime),"p")," - ","CANCELLED"===a.status?"ОТМЕНЕН":"ПОТВЪРДЕН"]})]}),"CANCELLED"!==a.status&&(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,b.jsx)("button",{onClick:()=>o(a),style:{background:"#f4f9fa",color:"var(--primary-teal)",border:"1px solid var(--primary-teal)",padding:"0.5rem 1rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"800"},children:"КАЛЕНДАР"}),(0,b.jsx)("button",{onClick:()=>n(a.id,a.dateTime),style:{background:"#fff5f5",color:"#c53030",border:"1px solid #feb2b2",padding:"0.5rem 1rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"800"},children:"ОТМЕНИ"})]})]},a.id))})})]})}a.s(["default",()=>h],77913)}];

//# sourceMappingURL=src_app_my-appointments_page_tsx_c0a4d24e._.js.map