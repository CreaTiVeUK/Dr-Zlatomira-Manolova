module.exports=[81779,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56711),e=a.i(42724),f=a.i(74016),g=a.i(67638);let h=[{name:"Стандартен преглед",duration:30,price:25},{name:"Специализирана консултация",duration:60,price:50}];function i(){let[a,i]=(0,c.useState)((0,g.startOfDay)(new Date)),[j,k]=(0,c.useState)(h[0]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(null),v=Array.from({length:7},(a,b)=>{var c;let d;return c=new Date,d=(0,f.toDate)(c,void 0),isNaN(b)?(0,e.constructFrom)(c,NaN):(b&&d.setDate(d.getDate()+b),d)});(0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/availability");if(a.ok){let b=await a.json();o(b.takenSlots)}}catch(a){console.error("Грешка при извличане на наличността:",a)}}()},[a]),(0,c.useEffect)(()=>{u(null);let b=[];for(let c=9;c<17;c++){let d=new Date(a);d.setHours(c,0,0,0),b.push(d);let e=new Date(a);e.setHours(c,30,0,0),b.push(e)}m(b)},[a]);let w=async a=>{s(""),q(!0);try{let b=await fetch("/api/appointments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dateTime:a.toISOString(),duration:j.duration,price:j.price,notes:`Услуга: ${j.name}`})}),c=await b.json();b.ok?window.location.href="/book/success":s(c.error||"Резервацията не бе успешна.")}catch(a){s("Възникна грешка.")}finally{q(!1)}};return(0,b.jsx)("div",{className:"section-padding bg-soft",style:{minHeight:"100vh"},children:(0,b.jsxs)("div",{className:"container",children:[(0,b.jsxs)("div",{className:"text-center",style:{marginBottom:"3rem"},children:[(0,b.jsx)("h1",{className:"section-title",children:"Онлайн записване на час"}),(0,b.jsx)("p",{style:{color:"var(--text-muted)"},children:"Запазете вашата консултация с д-р Злати в няколко лесни стъпки."})]}),(0,b.jsxs)("div",{style:{maxWidth:"900px",margin:"0 auto",background:"white",padding:"3rem",borderRadius:"8px",boxShadow:"var(--shadow-md)"},children:[(0,b.jsxs)("div",{style:{marginBottom:"3.5rem"},children:[(0,b.jsx)("h3",{style:{marginBottom:"1.5rem",borderBottom:"2px solid var(--bg-soft)",paddingBottom:"0.5rem"},children:"1. Изберете услуга"}),(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem"},children:h.map(a=>(0,b.jsxs)("button",{onClick:()=>{k(a),u(null)},style:{textAlign:"left",padding:"1.5rem",border:`2px solid ${j.name===a.name?"var(--primary-teal)":"var(--bg-soft)"}`,borderRadius:"8px",background:j.name===a.name?"#f4f9fa":"white",cursor:"pointer",transition:"all 0.2s",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontWeight:"700",fontSize:"1.1rem",color:j.name===a.name?"var(--primary-teal)":"var(--text-charcoal)"},children:a.name}),(0,b.jsxs)("div",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:[a.duration," мин"]})]}),(0,b.jsxs)("div",{style:{fontWeight:"700",color:"var(--primary-teal)"},children:[a.price," €"]})]},a.name))})]}),(0,b.jsxs)("div",{style:{marginBottom:"3.5rem"},children:[(0,b.jsx)("h3",{style:{marginBottom:"1.5rem",borderBottom:"2px solid var(--bg-soft)",paddingBottom:"0.5rem"},children:"2. Изберете дата"}),(0,b.jsx)("div",{style:{display:"flex",gap:"0.75rem",overflowX:"auto",paddingBottom:"1rem"},children:v.map(c=>(0,b.jsxs)("button",{onClick:()=>i((0,g.startOfDay)(c)),style:{padding:"1rem",background:(0,g.startOfDay)(c).getTime()===a.getTime()?"var(--primary-teal)":"white",color:(0,g.startOfDay)(c).getTime()===a.getTime()?"white":"var(--text-charcoal)",border:`1px solid ${(0,g.startOfDay)(c).getTime()===a.getTime()?"var(--primary-teal)":"#ddd"}`,borderRadius:"4px",cursor:"pointer",minWidth:"95px",flexShrink:0},children:[(0,b.jsx)("div",{style:{fontWeight:"bold",fontSize:"0.8rem",textTransform:"uppercase",marginBottom:"4px"},children:(0,d.format)(c,"EEE")}),(0,b.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:"700"},children:(0,d.format)(c,"d")}),(0,b.jsx)("div",{style:{fontSize:"0.75rem"},children:(0,d.format)(c,"MMM")})]},c.toISOString()))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{style:{marginBottom:"1.5rem",borderBottom:"2px solid var(--bg-soft)",paddingBottom:"0.5rem"},children:"3. Свободни часове"}),r&&(0,b.jsx)("div",{style:{padding:"1rem",background:"#fff9c4",color:"#827717",borderRadius:"4px",marginBottom:"1.5rem",fontSize:"0.9rem"},children:r}),(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(130px, 1fr))",gap:"1rem",marginBottom:"2.5rem"},children:l.map(a=>{var c;let e,f,g=(c=j.duration,f=(e=a.getTime())+60*c*1e3,n.some(a=>{let b=new Date(a.dateTime).getTime();return e<b+60*a.duration*1e3&&f>b})),h=t?.getTime()===a.getTime();return(0,b.jsxs)("button",{onClick:()=>!g&&u(a),disabled:p||g,style:{padding:"0.75rem",background:g?"#fafafa":h?"var(--primary-teal)":"white",border:`1px solid ${g?"#eee":"var(--primary-teal)"}`,borderRadius:"4px",color:g?"#ccc":h?"white":"var(--primary-teal)",cursor:g?"not-allowed":"pointer",fontWeight:"700",fontSize:"0.95rem",transition:"all 0.2s"},children:[(0,d.format)(a,"HH:mm"),g&&(0,b.jsx)("div",{style:{fontSize:"0.65rem",textTransform:"uppercase"},children:"Заето"})]},a.toISOString())})}),t&&(0,b.jsxs)("div",{style:{background:"var(--bg-soft)",padding:"2rem",borderRadius:"4px",textAlign:"center",border:"1px solid #ddd"},children:[(0,b.jsxs)("p",{style:{marginBottom:"1rem",fontSize:"1.1rem"},children:["Потвърдете ",(0,b.jsx)("strong",{children:j.name})," за ",(0,b.jsx)("strong",{children:(0,d.format)(t,"PPP 'в' HH:mm")}),"?"]}),(0,b.jsx)("button",{onClick:()=>w(t),disabled:p,className:"btn btn-primary",style:{width:"100%",maxWidth:"300px"},children:p?"ЗАПАЗВАНЕ...":"ПОТВЪРДИ ЧАС"})]})]}),p&&(0,b.jsx)("div",{style:{marginTop:"2rem",textAlign:"center",color:"var(--primary-teal)",fontWeight:"bold"},children:"Запазване на вашия час..."})]})]})})}a.s(["default",()=>i],81779)}];

//# sourceMappingURL=src_app_book_page_tsx_27775d69._.js.map